title: The Network-Max-P-Regions model
blocks:
- block_id: 0
  content: This paper introduces a new p-regions model called the Network-Max-P-Regions (NMPR) model. The NMPR is a regionalization
    model that aims to aggregate n areas into the maximum number of regions (max-p) that satisfy a threshold constraint and
    to minimize the heterogeneity while taking into account the influence of a street network. The exact formulation of the
    NMPR is presented, and a heuristic solution is proposed to effectively compute the near-optimized partitions in several
    simulation datasets and a case study in Wuhan, China.
  citations: []
- block_id: 1
  content: 'With the introduction of the p-regions problem (Duque et al. 2011b), the use of mixed integer programming (MIP)
    for regionalization has increased in the max-p-regions model (Duque et al. 2012), the p-functional regions model (Kim
    et al. 2013), and the p-compact regions model (Li et al. 2014b). However, most models ignore transportation networks (Borgatti
    et al. 2009). In addition, streets constrain human activities (Wheeler 1973, Whitehand and Larkham 1992, Jiang and Claramunt
    2004).


    This paper extends the max-p-regions model (Duque et al. 2012) to the Network-Max-P-Regions (NMPR) model. This is a regionalization
    model that aims to aggregate n areas into a maximum number of regions (max-p) such that (1) the resulting regions minimize
    a measure of intraregional heterogeneity, in terms of a set of areal attributes (e.g., slope, types of soil, types of
    land use, price); (2) the areas along streets can be grouped into ‘corridor regions,’ and other areas are grouped into
    ‘max-p regions;’ and (3) each region must satisfy the condition that the value of a spatially extensive areal attribute
    (e.g., population, households, size) exceeds a predefined threshold value.


    Physical constraints imposed by transportation networks shape the way in which human dynamics evolve (Jiang and Jia 2011).
    Therefore, the presence of a road might modify the attributes of the areas along it (e.g., percentage of vegetation cover,
    income, population density, commercial activity, land prices, percentage of impervious surfaces). This influence can be
    asymmetrical or symmetrical. The asymmetrical influence leads to the different attributes of the areas on either side
    of the road. For example, ring roads usually create a clear division between rural and urban areas (e.g., the northern
    edge of the A10 in Amsterdam, Netherlands), and streets separate neighborhoods with different socioeconomic characteristics
    (e.g., the 8 Mile Road in Detroit, USA). In those cases, the road acts as a regional border. The symmetrical influence
    might generate areas with similar attributes along both sides of the road (e.g., shopping strips, edge cities, or fishbone
    deforestation along roads). In this case, the regionalization process tends to generate corridor regions along the roads.


    However, due to the nature of the phenomenon (e.g., wildlife trails), or because of its short time period (e.g., recently
    constructed roads), the presence of the road may not have modified the attributes of the areas along it. In these cases,
    if the road is not explicitly included in the regionalization model, the infrastructure will be ‘invisible’ to the model.
    The NMPR is useful in such cases in which the influence of the roads cannot be captured through the area attributes, but
    the practitioner wants the resulting regions to be affected by those roads. To the best of our knowledge, the NMPR is
    the first regionalization model that allows for two types of regions: corridor regions (elongated regions along roads)
    and max-p-regions (shape-free regions located either close to or far from roads).


    Well-defined corridor regions are important in spatial planning. With proper land use planning along the roads connecting
    cities, the benefits of a road can spread to the intermediate areas that it crosses. Habitat attributes and information
    about migratory pathways can be integrated within the NMPR to delineate wildlife corridors used to protect species. In
    intra-urban applications, the NMPR can use a street network and block-wise commercial activity to design a zoning plan
    that includes both elongated shopping strips and compact business districts.


    The paper is structured as follows: Section 2 provides a literature review. The problem formation is established in Section
    3. Section 4 explains the heuristic framework used to solve the problem. Section 5 illustrates the proposed approach using
    several simulated datasets and a case study in Wuhan City, China. The last section discusses the strengths and limitations
    of the proposed method and suggests future work.'
  citations:
  - marker: (Duque et al. 2011b)
    intent_label: Domain Overview
    topic_label: p-regions formulations
  - marker: (Duque et al. 2012)
    intent_label: Model/Architecture Adoption
    topic_label: max-p regions formulations
  - marker: (Kim et al. 2013)
    intent_label: Prior Methods
    topic_label: p-regions formulations
  - marker: (Li et al. 2014b)
    intent_label: Prior Methods
    topic_label: p-regions formulations
  - marker: (Borgatti et al. 2009)
    intent_label: Research Gap
    topic_label: Other Intent
  - marker: (Wheeler 1973, Whitehand and Larkham 1992, Jiang and Claramunt 2004)
    intent_label: Domain Overview
    topic_label: Other Intent
  - marker: (Jiang and Jia 2011)
    intent_label: Importance of Problem
    topic_label: Other Intent
- block_id: 2
  content: 'Regionalization addresses the aggregation of spatial units (hereafter areas) into contiguous regions. It has been
    widely studied since the early 1960s, when electoral districting became a matter of quantitative modeling (Vickrey 1961,
    Nagel 1965, Bunge 1966, Aboolian et al. 2009). A few years later, the concept of spatial contiguity was applied to school
    districting (Clarke and Surkis 1968), sales territory alignment (Hess and Samuels 1971), health care districting (Thomas
    1979), zone design (Openshaw 1977), and police patrol areas (Curtin et al. 2010), among others (see Duque et al. 2007
    for a literature review of regionalization). Since the appearance of the p-regions problem as an MIP formulation of the
    regionalization problem (Duque et al. 2011b), research in this area has focused on proposing new exact formulations (Duque
    et al. 2012, Kim et al. 2013, Li et al. 2014b) and exploring new possibilities for solving large instances of this NP-hard
    problem using parallel computing (Laura et al. 2015). These regionalization algorithms are implemented in spatial analytical
    libraries, such as PySAL (https://pysal.readthedocs.io), and are integrated into GIS platforms (such as ArcGIS and QGIS)
    to assist researchers and practitioners in solving real-world spatial problems.


    The max-p-regions model (Duque et al. 2012) is the first MIP model to endogenize the number of regions. This is achieved
    by maximizing the number of homogeneous regions such that the value of a spatially extensive regional attribute (e.g.,
    area, population, presence of a given type of facility) is above a predefined threshold value. Because intraregional homogeneity
    is an important characteristic in regionalization, maximizing the number of regions is a good condition to keep heterogeneity
    low (minimum aggregation bias).


    The use of road networks in regionalization serve two purposes: first, it defines neighboring relationships between areas
    (Zoltners and Sinha 1983). In this case, two areas are neighbors if there is a road that connects them. This representation
    allows the inclusion of natural obstacles, such as mountains, lakes, and rivers. Second, it quantifies the attractiveness
    between areas by measuring flows of people, vehicles or products. This method is useful in designing functional or compact
    regions (Kim et al. 2013).


    Our NMPR model proposes a novel way to incorporate road networks into regionalization problems. In our model, the road
    network exerts an influence on the shape of the regions by considering the position of the areas relative to the road
    network. Thus, areas closer to roads tend to group along the roads, forming what we call ‘corridor regions.’ A challenging
    condition in the design of this model is that corridor regions are a possibility rather than a requirement. Corridor regions
    occur when they do not degrade the intra-regional homogeneity. This implies that corridor regions will not appear everywhere
    along the road network but only where they are needed.


    The NMPR is an NP-hard problem, implying that the computational complexity increases rapidly with the number of areas.
    This characteristic precludes the use of exact optimization techniques in large instances of the problem and requires
    the use of heuristic methods. Because of its capacity to escape from local optimal solutions, the Tabu search algorithm
    (Bozkaya et al. 2003) has proved to be the best option when addressing regionalization problems. It has been applied in
    political districting by Bozkaya et al. (2003) and Ricca and Simeone (2008), in zone design by Openshaw and Rao (1995),
    in home care districting by Blais et al. (2003), and more recently for the max-p-regions problem (Duque et al. 2012) and
    the p-compact-regions (Li et al. 2014a).'
  citations:
  - marker: (Duque et al. 2011b)
    intent_label: Prior Methods
    topic_label: p-regions formulations
  - marker: (Duque et al. 2012)
    intent_label: Prior Methods
    topic_label: max-p regions formulations
  - marker: (Kim et al. 2013)
    intent_label: Prior Methods
    topic_label: Exact optimization models
  - marker: (Vickrey 1961, Nagel 1965, Bunge 1966, Aboolian et al. 2009)
    intent_label: Domain Overview
    topic_label: Other Intent
  - marker: (Clarke and Surkis 1968)
    intent_label: Domain Overview
    topic_label: Other Intent
  - marker: (Hess and Samuels 1971)
    intent_label: Domain Overview
    topic_label: Other Intent
  - marker: (Thomas 1979)
    intent_label: Domain Overview
    topic_label: Other Intent
  - marker: (Openshaw 1977)
    intent_label: Domain Overview
    topic_label: Other Intent
  - marker: (Curtin et al. 2010)
    intent_label: Domain Overview
    topic_label: Other Intent
  - marker: (see Duque et al. 2007 for a literature review of regionalization)
    intent_label: Domain Overview
    topic_label: Other Intent
  - marker: (Duque et al. 2012, Kim et al. 2013, Li et al. 2014b)
    intent_label: Prior Methods
    topic_label: Exact optimization models
  - marker: (Laura et al. 2015)
    intent_label: Prior Methods
    topic_label: Other Intent
  - marker: (Zoltners and Sinha 1983)
    intent_label: Prior Methods
    topic_label: Other Intent
  - marker: (Bozkaya et al. 2003)
    intent_label: Prior Methods
    topic_label: Local search with area swaps and metaheuristics
  - marker: (2003)
    intent_label: Prior Methods
    topic_label: Local search with area swaps and metaheuristics
  - marker: (2008)
    intent_label: Prior Methods
    topic_label: Local search with area swaps and metaheuristics
  - marker: (1995)
    intent_label: Prior Methods
    topic_label: Local search with area swaps and metaheuristics
  - marker: (Li et al. 2014a)
    intent_label: Prior Methods
    topic_label: Local search with area swaps and metaheuristics
- block_id: 3
  content: 'The NMPR model is formulated as a MIP model. It builds upon the max-p-regions model devised by Duque et al. (2012),
    which implies that (1) the number of final regions is endogenously defined, (2) the intraregional heterogeneity is minimized,
    and (3) each region is spatially contiguous.


    Parameters:

    I = set of areas; I = 1, ..., n;

    i, j = indices used to represent areas; with i, j in I;

    k = index of potential regions; k = 1, ..., n;

    c = index of order for areas; c = 0, ..., q; with q = n/(C0 1) ;

    wij = 1, if areas i and j share a border; with i, j in I and i ≠ j;

    0, otherwise

    Ni = { j | wij = 1 }; the set of areas that are adjacent to area i;

    dij = dissimilarity of the relationships between areas i and j; with i, j in I and i < j; it is left to the practitioner
    to decide which dissimilarity function to use. In this paper, we use the squared Euclidean distance.

    h = 1 + log(sum_i sum_{j≠i} dij); which is the number of digits of the floor function of sum_i sum_{j≠i} dij; with i,
    j in I;

    li = spatially extensive attribute value of area i; with i in I;

    threshold = minimum value for attribute l at a regional scale;

    E, e = set and index of edges in an undirected network; E = 1, ..., m;

    vi = 1, if area i intersects an edge e in E;

    0, otherwise

    Oi = { e in E } and it is the nearest edge to area i in I; for each area i, there is only one nearest edge e;

    si,Oi = spatial distance between area i in I and its closest edge Oi;


    Decision variables:

    tij = 1, if areas i and j belong to the same region k; with i < j;

    0, otherwise

    xkc_i = 1, if area i is assigned to region k in order c;

    0, otherwise

    ck = 1, if region k is a corridor region;

    0, otherwise

    bk_ij = 1, if areas i and j belong to the same corridor region k; with i < j;

    0, otherwise


    Minimize:

    z = - sum_{k=1}^n sum_{i=1}^n xk0_i * 10^h + sum_i sum_{j≠i} dij tij - sum_i sum_{j≠i} dij f(s_i, O_i; s_j, O_j) sum_{k=0}^n
    bk_ij


    Subject to:

    sum_{i=1}^n xk0_i ≤ 1,  for all k = 1, ..., n;

    sum_{k=1}^n sum_{c=0}^q xkc_i = 1,  for all i = 1, ..., n;

    xkc_i ≤ sum_{j in Ni} xk(c-1)_j, for all i = 1, ..., n; k = 1, ..., n; c = 1, ..., q;

    sum_{i=1}^n sum_{c=0}^q xkc_i li ≥ threshold * sum_{i=1}^n xk0_i, for all k = 1, ..., n;

    tij ≥ sum_{c=0}^q xkc_i + sum_{c=0}^q xkc_j - 1, for all i, j = 1, ..., n with i<j; k = 1, ..., n;

    xkc_i in {0,1};

    tij in {0,1}, for all i, j with i<j;

    sum_{i=1}^n sum_{c=0}^q xkc_i vi ≥ ck, for all k = 1, ..., n;

    3 bk_ij ≤ sum_{c=0}^q xkc_i + sum_{c=0}^q xkc_j + ck, for all i, j with i<j; k = 1, ..., n;

    bk_ij ≥ sum_{c=0}^q xkc_i + sum_{c=0}^q xkc_j + ck - 2, for all i, j with i<j; k = 1, ..., n;

    ck in {0,1}, for all k = 1, ..., n;

    bk_ij in {0,1}, for all i, j with i<j; k = 1, ..., n.


    Objective function has three terms combined in such a way that term I dominates terms II and III. This is achieved by
    multiplying term I by a scaling factor 10^h, with h = 1 + log(sum_i sum_{j≠i} dij). When terms I, II, and III are added
    as a single value (-I+II-III), this scaling factor moves term I to the left so that it is not combined with terms II and
    III. This strategy was first applied by Duque et al. (2012) in the max-p-regions model.


    Term I represents the number of regions calculated as the sum of root areas (i.e., the area assigned at order equal to
    zero, xk0_i). To maximize the number of regions, term I is multiplied by −1 so that the greater the number of regions,
    the lower the objective function. Term II adds dissimilarity between areas assigned to the same region (i.e., tij = 1).
    For this, practitioners can use either distance or dissimilarity functions in a univariate or multivariate context. Finally,
    term III represents an incentive to create corridor regions by subtracting a portion of the intraregional heterogeneity
    of the corridor region from term II. The portion to be subtracted is determined by a factor f with the following structure:


    f(s_i, O_i; s_j, O_j) = MaxDisc - MaxDisc/MaxDist * (s_i,O_i + s_j,O_j),


    where MaxDisc is the maximum discount to be applied to dij. The maximum discount occurs when both areas i and j are very
    close to a road (i.e., s_i,O_i + s_j,O_j → 0). This MaxDisc decreases as the distance between i or j and the road increases
    (i.e., s_i,O_i + s_j,O_j → ∞). MaxDist indicates the threshold distance beyond which the discount becomes negative, which
    discourages the appearance of corridor regions far from roads.


    Note that areas closer to the roads have a greater incentive to become corridor areas because the discount is higher.
    The discount function can have other functional forms depending on the research question.


    Solutions with a higher number of regions are always preferred, and for a given number of regions, solutions with lower
    intraregional heterogeneity (calculated with terms II and III) are preferred over solutions with higher intraregional
    heterogeneity. Constraints (2)–(8) correspond to the max-p-regions. Constraints (2)–(4) guarantee the spatial contiguity
    of the regions by using an extension of the ordered-area assignment conditions proposed by Cova and Church (2000). Constraint
    (2) guarantees that each region k has no more than one root area. Constraint (3) requires that each area i is assigned
    to only one region k and only one order c. Constraint (4) ensures spatial contiguity by allowing an area i to be assigned
    to a given region k in order c if and only if there exists an area j in the neighborhood of i that is assigned to the
    same region k in the order c-1. Constraint (5) ensures that each region satisfies the minimum threshold value imposed
    over a spatially extensive attribute. Constraint (6) identifies the pairwise relationships involving areas assigned to
    the same region. Constraints (7) and (8) impose variable integrity.


    The NMPR adds the following constraints to the original max-p-regions model. Constraint (9) allows a region k to become
    a corridor region if at least one of its areas intersects an edge of the network. A link bk_ij indicates that both areas
    i and j belong to a corridor region k. However, because of the form of the discount function, the activation of link bk_ij
    can imply both a decrease in the objective function (when the areas are close to a road, i.e., a positive discount function),
    or an increase in the objective function (when the areas are far from a road, i.e., a negative discount function). Because
    all the bk_ij links between areas belonging to a corridor region are activated, a region is declared a corridor region
    when the total effects of the discount function lead to a positive value of the third term in the objective function.
    Constraints (10) and (11) activate all the bk_ij links between areas belonging to the region, but they act in different
    situations: constraint (10) controls the appearance of bk_ij links with a positive discount value by requiring that bk_ij
    links are only accepted when both areas belong to a corridor region. In contrast, constraint (11) forces the opening of
    those bk_ij links with a negative discount value; it mandates that these bk_ij links be opened when areas i and j are
    assigned to the same corridor region. Finally, constraints (12) and (13) impose variable integrity.


    To illustrate how the NMPR model works, examples of the max-p-regions and the NMPR models are provided in the text. Note
    the differences in the configuration of the regions; the presence of the road in the NMPR model has a direct effect on
    the shape of the regions. The NMPR model places a corridor region along two segments of the road network in areas 0, 4,
    5, and 6. The other three regions are max-p-regions.


    Computational experiments with the exact formulation show the complexity of this NP-hard problem and the convenience of
    using heuristic approaches to solve large instances.'
  citations:
  - marker: Duque et al. (2012)
    intent_label: Model/Architecture Adoption
    topic_label: max-p regions formulations
  - marker: Cova and Church (2000)
    intent_label: Algorithm/Principle Adoption
    topic_label: Order-based core assignment models
- block_id: 4
  content: In this section, we present a heuristic solution for solving the NMPR model. We followed a classical heuristic
    approach for solving regionalization problems, extending the algorithm to solve the Max-p problem (Duque et al. 2012).
    First, we generated a large amount of initial feasible solutions, and second, we performed a local search by modifying
    a subset of initial solutions with the goal of improving the objective function.
  citations:
  - marker: (Duque et al. 2012)
    intent_label: Algorithm/Principle Adoption
    topic_label: max-p regions formulations
- block_id: 5
  content: "This stage generates a large number of initial feasible solutions at random with different numbers of corridor\
    \ regions and max-p regions. Pseudocode 1 presents the steps for generating initial feasible solutions. It consists of\
    \ four steps: area filtering, adaptive region formation, partition ranking and filtering, and enclaving.\n\nArea filtering\n\
    In this phase, the areas become regions by themselves when li ≥ threshold. If an area intersects the road network, it\
    \ is categorized as a corridor region; otherwise, it becomes a max-p region.\n\nAdaptive region formation\nThis phase\
    \ builds upon the seeded regions strategy first proposed by Vickrey (1961), which is widely used in the context of regionalization\
    \ (Thoreson and Liittschwager 1967, Openshaw 1977, Rossiter and Johnston 1981, Duque et al. 2012). This method selects\
    \ an area at random and grows a region around it. The algorithm starts with areas that intersect the road network to generate\
    \ corridor regions. During the growing process, a region can change from a corridor to a max-p region if this benefits\
    \ the objective function. This phase is completed when it is not possible to grow new feasible regions. The remaining\
    \ unassigned areas are called ‘enclaves’ (Duque et al. 2012).\n\nPartition ranking and filtering\nAt this point, the method\
    \ has yielded n partial solutions. Each partial solution generates a given number of regions. This stage creates a set\
    \ P of partial solutions with the maximum number of regions (the other partial solutions are discarded).\n\nEnclaving\n\
    This stage takes each partial solution in P and transforms it to a feasible solution by assigning the enclave (unassigned)\
    \ areas to an existing region. This process is based on the greedy-based assignation process, AssignEnclaves, devised\
    \ by Duque et al. (2012). As with the max-p-regions model, the random component in this stage (specifically in the Adaptive\
    \ region formation step) is a key feature to guarantee proper exploration of the solution space. Because the number of\
    \ regions (p) is determined in this stage, it is important to generate a large number of initial feasible solutions to\
    \ increase the possibility of finding a large number of regions.\n\nPseudocode 1. Generate initial feasible solutions.\n\
    \n1 P = {} Candidate partition set  \n2 for i = 1 to n:  \n3   P = Initialize a partition P with areas G.  \n4   SU =\
    \ empty list; unsigned areas  \n5   SE = empty list; enclaved areas  \n6   Area filtering:  \n7     for each gi in G do:\
    \  \n8       if ati ≥ threshold:  \n9         ek = the nearest edge to Ii  \n10        Rk = create a corridor region if\
    \ ek intersects with gi,  \n11        if not, create a max-p region  \n12        add gi to Rk  \n13      else:  \n14 \
    \       add gi to SU  \n15  Adaptive region formation:  \n16    while SU ≠ ∅:  \n17      g = randomly select an area from\
    \ SU, starting from those areas that intersect with the network N  \n18      Ri = Initialize a new region for P, with\
    \ the seed area g  \n19      add g to Ri, remove g from SU  \n20      while lR < threshold:  \n21        if Ri don’t have\
    \ neighbor areas:  \n22          break;  \n23        g' = Ri.popMinNeighborArea();  \n24        add g' to Ri, remove g'\
    \ from SU;  \n25      if aR < threshold:  \n26        remove Ri from P  \n27        add all areas in Ri to SE  \n28  \
    \  P.setEnclavedAreas(SE)  \n29    P.add(P)  \n30  Partition ranking and filtering:  \n31    max = P.maxNumRegions() \
    \ \n32    P = P.filterByNumRegions(max)  \n33  Enclaving:  \n34    for each P in P do:  \n35      enclave(P, P.getEnclavedAreas())"
  citations:
  - marker: (Duque et al. 2012)
    intent_label: Algorithm/Principle Adoption
    topic_label: Bottom-up seeded agglomeration
  - marker: Duque et al. (2012)
    intent_label: Algorithm/Principle Adoption
    topic_label: Bottom-up seeded agglomeration
  - marker: Vickrey (1961)
    intent_label: Algorithm/Principle Adoption
    topic_label: Bottom-up seeded agglomeration
  - marker: (Thoreson and Liittschwager 1967, Openshaw 1977, Rossiter and Johnston 1981, Duque et al. 2012)
    intent_label: Prior Methods
    topic_label: Bottom-up seeded agglomeration
- block_id: 6
  content: "The local search algorithm iteratively modifies an initial feasible solution by moving areas from one region to\
    \ a neighboring region. This type of move was first applied by Nagel (1965) and is widely utilized in the literature.\
    \ Duque et al. (2007) summarized other types of moves.\n\nTo guarantee a good exploration of the solution space, we provide\
    \ the local search with the following features: first, the candidate areas that move between regions are selected at random.\
    \ Second, we use a local Tabu search that allows temporary worsening of the objective function as a strategy to escape\
    \ from local optimal solutions. When an area is swapped from one region to another, the area–region relationship is altered;\
    \ a corridor region could become a max-p region or vice versa. Finally, a unique feature of the Tabu search within the\
    \ context of the NMPR problem regards local movements that modify a region intersecting the road network; these force\
    \ the algorithm to evaluate the objective function under two scenarios, corridor and max-p regions, for both the donor\
    \ and the recipient regions.\n\nPseudocode 2 presents the Tabu search procedure. Sb and Sc represent the best solution\
    \ and the current solution. The candidate moves contain all the moves that will not break the spatial contiguity constraints.\
    \ These moves are computed using the inner border areas across all regions in the partition. Sd is the temporary best\
    \ solution from applying a move, and it is chosen if it is not in the Tabu list and if it is better than Sc. This is the\
    \ design of Tabu search to avoid local entrapments as much as possible. convTabu and tabuLength are the two Tabu search\
    \ parameters used to control the stop condition and the length of the Tabu list.\n\nPseudocode 2. Tabu search procedure.\n\
    \n1 Sb, Sc = the current solution  \n2 int c = 0  \n3 P = {} Tabu solution set  \n4 while c ≤ convTabu:  \n5   Sd = ∅;\
    \  \n6   while true:  \n7     move = select a random move  \n8     if move = ∅:  \n9       break  \n10    Sn = apply the\
    \ move to Sc, and remove the move from candidate moves  \n11    if Sn = ∅:  \n12      continue  \n13    if tabuList.contains(Sn):\
    \  \n14      continue  \n15    if Sn.betterThan(Sc):  \n16      Sd = Sn  \n17      break;  \n18    if Sd = ∅:  \n19  \
    \    break  \n20   if Sd.betterThan(Sb):  \n21     Sb = Sd  \n22   Sc = Sd  \n23   Sc.updateCandidateMoves()  \n24   tabuList.add(Sd)\
    \  \n25   if |tabuList| > tabuLength:  \n26     remove the first element from tabuList  \n27 return Sb"
  citations:
  - marker: Nagel (1965)
    intent_label: Prior Methods
    topic_label: Local search with area swaps and metaheuristics
  - marker: Duque et al. (2007)
    intent_label: Prior Methods
    topic_label: Local search with area swaps and metaheuristics
- block_id: 7
  content: This section analyzes the two network-related parameters, MaxDisc and MaxDist. The solution quality is also validated
    through randomized experiments. A real-world example is then given to show the model’s scalability. The algorithms were
    implemented in Java and tested on a machine with an i7-4710HQ Intel CPU and 16G DDR3 memory.
  citations: []
- block_id: 8
  content: 'The simulated areas were retrieved from sample data in the ClusterPy library for regionalization research (Duque
    et al. 2011a). The data include three datasets with different numbers of areas (n = 529, n = 1024, and n = 2025). The
    attribute value for each area is generated using a spatial autoregressive process with ρ = 0.9. The attribute for the
    threshold constraint follows a uniform distribution of [10, 15] (https://code.google.com/p/clusterpy/). A network dataset
    with 16 edges was designed over the grid areas.


    One heuristic solution for the dataset with n = 1024 used the following parameters: threshold = 500, number of initial
    solutions = 10,000, TABU length = 85, MaxDisc = 0.3 and MaxDist = 10. Corridor regions are marked in dark grey in the
    original visualization.


    To quantitatively assess how MAX_DIST and MAX_DISC affect the results, two measures are proposed: the number of corridor
    regions, Nc, and the average corridor region compactness, C_bar. These are defined as follows:


    C_bar = (sum_{R in Rc} c_R) / Nc,


    where Rc is the set of corridor regions of the partition and c_R = (sum_{j in R} s_{i,O_i}/N_R - s_min) / (s_max - s_min)
    is the compactness of a particular corridor region. c_R is a standard measure with the range [0, 1]. s_min and s_max are
    the minimum and maximum values of all the area-closest-edge distances.


    A series of experiments was performed on a dataset with n = 529 to evaluate the impacts of MAX_DIST and MAX_DISC. The
    other parameters were set as follows: threshold = 110, number of initial solutions = 10,000, and TABU length = 85.


    The experiments emphasize that MAX_DIST has major effects. For a given value of MAX_DISC, both C_bar and Nc increase with
    MAX_DIST. As MAX_DIST grows, the discount function has a positive sign over a greater portion of the map, which implies
    a reduction in the objective function via the third term. Thus, the capacity for constructing corridor regions is higher.
    The speed of growth slows as MAX_DIST approaches a certain value and then stabilizes. This indicates that the measure
    has reached a threshold where no further benefit can be gained through the third term with larger values of MAX_DIST.
    The same rationale applies to the compactness measure: small MAX_DIST values force the corridor regions to be very close
    to the road (i.e., they become more elongated). Conversely, larger MAX_DIST values force areas far from the road to become
    part of a corridor region. Again, there is a certain point after which MAX_DIST produces no more benefits in terms of
    the objective function value.


    MAX_DISC does not differ significantly for a given value of MAX_DIST but remains relatively stable. This suggests that
    in real applications, what matters is how far from the road we extend the premium for corridor regions (i.e., MAX_DIST).
    Given the linearity of the discount function, it is straightforward for practitioners to relate MAX_DIST to the parameters
    in domain-specific problems.


    The following experiment is conducted to illustrate the solution quality of the heuristic algorithm. For the same parameters
    of the problem shown earlier, 1000 random solutions are generated (not improved by the heuristic algorithm). Then, 20
    heuristic solutions are generated and compared with those random solutions. Because the number of regions dominates other
    terms in the objective value function, the random solutions and the heuristic solutions are generated for a fixed number
    of regions k. This is achieved by generating as many random solutions as possible until 1000 random solutions are produced
    with the number of regions equal to k, and the same process is repeated to produce the 20 heuristic solutions.


    The histogram of the objective values for the random solutions shows that the objective values of the heuristic solutions
    are clear outliers of low values against the histogram, which shows that the quality of the heuristic is reasonable.'
  citations:
  - marker: (Duque et al. 2011a)
    intent_label: Benchmark Utilization
    topic_label: Other Intent
- block_id: 9
  content: 'Wuhan is a rapidly growing city and is the largest city in central China. Its modernization process is reflected
    by the expansion of the street network. By 2014, the total road length had reached 14,520 kilometers, with a road density
    of 180.85 kilometers per 100 square kilometers. By integrating these networks into the regionalization process, the NMPR
    formulation has practical implications because the development of the urban street network in Wuhan has led to greater
    accessibility among areas and rapid development along the streets.


    We use the Wuhan grid-level data with its main street network. There are 7,766 one-kilometer grids and 386 network edges.
    The population from the 2000 census was used as the aggregation variable, and the threshold was set to 100,000 people.
    The urban land use area was chosen as the heterogeneity variable. Urban land use is largely clustered in the center and
    scattered along the roads far from the center. Some roads act as regional borders, such as the ring roads around the central
    area. Areas around the roads that expand outwards largely show similar attributes, regardless of their distance from the
    roads. The core of the city has a dense street network occupied by many urbanized areas.


    We ran both the max-p-regions and the NMPR models. The number of initial partitions was set to 200, the threshold value
    was 100,000 people, and the Tabu length was 85. For the NMPR formulation, MAX_DISC was set to a moderate value of 0.5,
    and MAX_DIST was set to 2 kilometers. The actual values of the parameters, including MAX_DISC, MAX_DIST and the threshold,
    should be based on physically meaningful values determined by practitioners.


    The max-p-regions procedure took 495.3 s to finish, while the NMPR procedure took 935.5 s. Both partitions generated 66
    regions, but the NMPR partition included 43 corridor regions. The result shows a clear pattern of corridor regions in
    the NMPR formulation. The corridor regions are largely aggregated in the urban center, where the street networks are also
    clustered. These areas are more likely to benefit from the formation of corridor regions, producing lower objective function
    values due to a higher value of the third term.'
  citations: []
- block_id: 10
  content: 'The NMPR model is a novel approach to incorporate the street network structure into a regionalization problem.
    This is the first regionalization model that allows both corridor regions and max-p regions. The model would be useful
    in a wide array of applications, including land use planning, districting, and other areas within the domain of geographical
    information science. The NMPR model allows researchers and practitioners to explicitly take the structure of the street
    network into account, balancing the formation of corridor regions and regional heterogeneity.


    The MAX_DIST parameter in the objective function affects the formation and features of the corridor regions in a near-logarithmic
    fashion. MAX_DIST influences the partitions through the objective function in a linear way. Compared to more complex measures,
    such as the tortuosity of network segments, it is a simple parameter; however, it performs surprisingly well. Parameter
    analysis reveals the bounded characteristics of this parameter, which could serve as guidelines for practitioners to modify
    it.


    This study assumes a homogeneous network and only considers geometric network properties. Future work could investigate
    stricter formulations for the network. For example, an additional restriction could be that edges in a corridor region
    must be a connected subnetwork. In addition, the street structure contains rich semantic information, including rank,
    capacity, and traffic load. These attributes can be integrated into the objective function.


    This paper establishes a framework for network regionalization problems. The network structure is incorporated into the
    exact formulation without sacrificing its rigor, while the heuristic algorithms provide an efficient method for regional
    growth testing and solution optimization. Both the formulation and the heuristic can be transferred to other optimization
    problems. This would greatly facilitate regionalization applications.'
  citations: []
