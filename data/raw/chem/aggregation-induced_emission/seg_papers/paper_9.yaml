title: Discovery of highly fluorescent covalent organic frameworks through AI-assisted
  iterative experiment–learning cycles
abstract: 'The development of porous crystalline materials with targeted properties
  remains challenging owing to the vast chemical design space and the high cost of
  experimental screening. Here we develop an artificial-intelligence-assisted interactive
  experiment–learning evolution approach to accelerate the discovery of highly fluorescent
  covalent organic frameworks (COFs). This approach integrates model recommendation,
  experimental validation and active learning in an iterative refinement cycle, allowing
  the artificial intelligence model to evolve along the process. Among the 520 possible
  combinations derived from a library of 20 amine (ami) and 26 aldehyde (ald) building
  blocks, we needed to experimentally evaluate only 11 COFs to identify one with a
  remarkable photoluminescence quantum yield of 41.3%. By embedding electronic configuration
  and quantum-level insights into the learning process, this approach transcends intuition
  based on statistical analysis intuition to enable material discovery driven by chemical
  knowledge, enhancing prediction reliability and interpretability. We also reveal
  the fluorescence mechanism of these COFs and outline the critical role of HOMO–LUMO
  alignment and excited-state charge distribution.


  Covalent organic frameworks (COFs), which are constructed by linking molecules through
  covalent bonds, represent a class of crystalline materials with high structural
  diversity[1–6]. Their modular design enables systematic control over structure and
  function, leading to exceptional physical and chemical properties that make them
  useful in separation[7,8], catalysis[9–14] and biological applications[15,16]. However,
  the discovery of COFs with targeted properties remains a major challenge. This difficulty
  stems from the combinatorial explosion of possible building block pairs, making
  exhaustive experimental screening impractical, even with the support of theoretical
  models and structural simulations.


  In this study, we develop an interactive experiment–learning evolution approach
  to allow interplay between experienced researchers and artificial intelligence (AI)
  models, in which the AI model is refined and evolves iteratively along the process.
  We apply this strategy to the discovery of fluorescent COFs constructed from 20
  amine (ami) and 26 aldehyde (ald) building blocks, linked through imine condensation
  to form a series of two-dimensional (2D) frameworks. A multilayer perceptron (MLP)
  was used to pretrain a model based on density functional theory (DFT) calculations
  of 520 dimers and orbital-level descriptors of the building blocks, followed by
  a Siamese neural network to recommend new candidates in subsequent learning cycles.
  Using this approach, we identified a COF with a photoluminescence quantum yield
  (PLQY) of 41.3% after only four generations of experiment–model iteration.'
abstract_is_verbatim: true
segmented_markdown: '# Discovery of highly fluorescent covalent organic frameworks
  through AI-assisted iterative experiment–learning cycles


  ## Abstract

  <block id="0">

  The development of porous crystalline materials with targeted properties remains
  challenging owing to the vast chemical design space and the high cost of experimental
  screening. Here we develop an artificial-intelligence-assisted interactive experiment–learning
  evolution approach to accelerate the discovery of highly fluorescent covalent organic
  frameworks (COFs). This approach integrates model recommendation, experimental validation
  and active learning in an iterative refinement cycle, allowing the artificial intelligence
  model to evolve along the process. Among the 520 possible combinations derived from
  a library of 20 amine (ami) and 26 aldehyde (ald) building blocks, we needed to
  experimentally evaluate only 11 COFs to identify one with a remarkable photoluminescence
  quantum yield of 41.3%. By embedding electronic configuration and quantum-level
  insights into the learning process, this approach transcends intuition based on
  statistical analysis intuition to enable material discovery driven by chemical knowledge,
  enhancing prediction reliability and interpretability. We also reveal the fluorescence
  mechanism of these COFs and outline the critical role of HOMO–LUMO alignment and
  excited-state charge distribution.


  Covalent organic frameworks (COFs), which are constructed by linking molecules through
  covalent bonds, represent a class of crystalline materials with high structural
  diversity[1–6]. Their modular design enables systematic control over structure and
  function, leading to exceptional physical and chemical properties that make them
  useful in separation[7,8], catalysis[9–14] and biological applications[15,16]. However,
  the discovery of COFs with targeted properties remains a major challenge. This difficulty
  stems from the combinatorial explosion of possible building block pairs, making
  exhaustive experimental screening impractical, even with the support of theoretical
  models and structural simulations.


  In this study, we develop an interactive experiment–learning evolution approach
  to allow interplay between experienced researchers and artificial intelligence (AI)
  models, in which the AI model is refined and evolves iteratively along the process.
  We apply this strategy to the discovery of fluorescent COFs constructed from 20
  amine (ami) and 26 aldehyde (ald) building blocks, linked through imine condensation
  to form a series of two-dimensional (2D) frameworks. A multilayer perceptron (MLP)
  was used to pretrain a model based on density functional theory (DFT) calculations
  of 520 dimers and orbital-level descriptors of the building blocks, followed by
  a Siamese neural network to recommend new candidates in subsequent learning cycles.
  Using this approach, we identified a COF with a photoluminescence quantum yield
  (PLQY) of 41.3% after only four generations of experiment–model iteration.


  </block>

  ## Results and discussion

  <block id="1">

  There are three key steps in the workflow: (1) dataset curation, (2) model building
  and (3) experiment–learning evolution.


  </block>

  ### Dataset curation and encoding

  <block id="2">

  LLMs have proven efficient in screening potential organic units for the synthesis
  of MOFs[24–26]. Here we applied a similar methodology to COFs, in which 20 ami and
  26 ald units were identified as candidate building blocks for the construction of
  2D imine-linked COFs with bex topology (Supplementary Note 1 and Extended Data Figs.
  1 and 2). However, for the encoding process, pivoting to active learning, a new
  set of parameters consisting of electronic structures of the building blocks was
  used; this was in contrast to previous work on porous crystals. Specifically, a
  set of 14 key electronic structure parameters of all 46 building blocks from time-dependent
  DFT calculations were encoded as feature vectors for the machine learning models,
  capturing the excited-state electron–hole dynamics and electrophilic reactivity
  of the building blocks (Supplementary Note 1).


  </block>

  ### Model building and pretraining

  <block id="3">

  In the following step, an AI model was needed to establish a correlation between
  the building blocks and the targeting fluorescence properties of the corresponding
  COFs. Conventionally, compositional and chemical information for individual motifs
  or building blocks has been used to predict the properties of the entire extended
  framework. However, the electronic properties of the extended frameworks usually
  differed markedly from those of their isolated building blocks.


  To bridge the knowledge gap in the AI model, we used a dimer composed of one ald
  and one ami building block with an imine linkage as an intermediate molecule connecting
  the structural variables and the electronic states of the corresponding COF. Based
  on single-crystal structures of 2D imine COFs[29], we assigned a trans conformation
  to the imine linkage in the dimer and constrained both building blocks to an in-plane
  configuration to mimic their arrangement in the 2D COF layers (Extended Data Fig.
  3 and Supplementary Figs. 25–29). DFT calculations were performed on the dimers
  constructed by a previously curated dataset of 20 ami and 26 ald units; the results
  showed a critical excited-state charge redistribution facilitated by imine bonds,
  in which the contributions from the ami and ald units were captured. A machine learning
  model based on MLP, which is well known for its efficient handling of variables
  in large numbers, was built for pretraining, with 28 descriptors extracted from
  the building blocks as the input and DFT calculation results for 520 dimer combinations
  as the output.


  Direct excited-state calculations of entire periodic COF structures are deemed to
  be computationally prohibitive, particularly considering 520 possible combinations,
  whereas classic treatment based on building-block-only calculations suffers from
  low accuracy. The dimer approach employed here strikes an optimal balance between
  computational efficiency and the need for accurate representation of extended COF
  structures, thereby providing insights into excited-state properties that more closely
  approximate the actual COF structures.


  </block>

  ### Interactive experiment–learning evolution

  <block id="4">

  The subsequent stage involved the core evolution process, in which experimental
  results played an integral part in refinement of the AI model. Given that all 520
  COF candidates had identical connectivity and similar topology (Supplementary Table
  1), we used a Siamese neural network model, a type of model that excels at learning
  similarities based on limited data points. Utilizing a compact ten-dimensional vector
  embedding (Supplementary Note 1), the Siamese neural network successfully predicted
  the strongest fluorescent COFs in bex topology. Photoluminescent COFs (PL-COFs)
  PL-COF-10 and PL-COF-11, with 21% and 41.3% quantum yield (Supplementary Tables
  2 and 3), respectively, were identified through a fast track with 4 generations
  of interactive experiment–learning evolution.


  Specifically, the active learning process was initiated with five randomly selected
  candidates from the chemical space as preliminary recommendations, PL-COF-1 to PL-COF-5,
  termed the first generation (Gen I). The initial results revealed suboptimal performance
  for most of the synthesized COFs, except for PL-COF-4, which exhibited an absolute
  solid PLQY of 10.6%. These experimental results were incorporated into the dataset
  as the start of the AI model.


  Starting from the second generation (Gen II), a sequential active learning iteration
  approach was adopted. In each iteration, one COF was predicted and investigated
  experimentally, after which the AI model was refined, incorporating new experimental
  input, and then used for the next prediction. Following three iterations in Gen
  II, the averaged fluorescence quantum yield of three recommended COFs, PL-COF-6,
  PL-COF-7 and PL-COF-8, was 8.7%; this was higher than that of the initial five random
  recommendations (2.7%). PL-COF-8 had a PLQY of 11%, readily surpassing that of PL-COF-4,
  which had the highest PLQY in Gen I. After Gen II, another three iterations were
  performed as the third generation (Gen III). The average PLQY of COFs in this cycle,
  PL-COF-9, PL-COF-10 and PL-COF-11, was 27%, much higher than that achieved in Gen
  II. Notably, PL-COF-11 achieved the highest PLQY of 41.3%, positioning it as a promising
  candidate within the explored chemical space. Notably, even PL-COF-10, with the
  second highest PLQY of 21%, performed comparably to the state-of-the-art fluorescent
  2D COF under the same bex topology[30] (Supplementary Tables 2 and 3).


  Finally, an additional set of experiments was conducted to further evaluate the
  robustness and generality of the model predictions as the fourth generation (Gen
  IV), with 11 additional COFs (PL-COF-12 to PL-COF-22) selected from regions in the
  chemical space adjacent to high-performing candidates. Despite the structural similarity
  to previous ones, these COFs exhibited relatively weak fluorescence, with an average
  PLQY of 1.5%. These results agreed well with the predictions from the model and
  further demonstrate the power of the Siamese neural network in structure recommendation
  based on the limited experimental dataset that was accessible.


  The tool chosen for the data refinement within the machine learning process is crucial.
  Bayesian optimization, as used in conventional AI models, is good at prediction
  based on a large number of experimental results, in cases in which the experimental
  results are relatively easy to obtain and constitute a continuous chemical space[28,31].
  However, each COF involves a combination of discrete building blocks, and time-consuming
  experimental investigation of each COF is required to yield a single reliable data
  point, even for the most experienced researchers in the field. Such experimental
  processes include but are not limited to synthesis of building block molecules,
  growth of COF crystals, sample accumulation and activation, followed by structural
  confirmation and fluorescence property characterization. This renders conventional
  high-throughput Bayesian optimization impractical for the problem at hand. Indeed,
  even after all 22 COF data points had been obtained and used as feedback, the Bayesian
  approach failed to yield a reasonable and converged prediction model.


  </block>

  ### Construction and characterization of 22 PL-COFs

  <block id="5">

  The construction of COFs requires substantial experimental effort, including the
  synthesis of molecular building blocks, the growth of COF crystals, and their activation.
  In total, 22 high-quality COF crystals were obtained through optimization of crystal
  growth conditions, which involved 11 ald units (termed Ald-1, Ald-7, Ald-8, Ald-10,
  Ald-11, Ald-13, and Ald-20 to Ald-25) and 6 ami units (Ami-8, Ami-10, Ami-11, Ami-12,
  Ami-15 and Ami-17) (Extended Data Figs. 1 and 2, Supplementary Note 2 and Supplementary
  Figs. 25–29). These steps have the potential to be incorporated into automated systems
  in the future[32], but here they were executed manually to demonstrate the compatibility
  of this AI-assisted approach with the standard operations accessible in most laboratories.


  Powder X-ray diffraction (PXRD) analysis was performed on these COFs using laboratory-based
  X-ray sources, with selected samples further confirmed by synchrotron-based analysis.
  The PXRD patterns exhibited sharp diffraction peaks, indicating high crystallinity.
  PXRD pattern refinement revealed a common bex topology in most of these COFs (Supplementary
  Table 1 and Supplementary Figs. 33–53), except for one in Gen IV (PL-COF-22). The
  formation of imine linkages was confirmed through a series of spectroscopic analyses,
  including Fourier transform infrared spectroscopy (Supplementary Note 3 and Supplementary
  Figs. 54–75), X-ray photoelectron spectroscopy (Supplementary Note 4 and Supplementary
  Figs. 76–97) and solid-state 13C cross-polarization nuclear magnetic resonance spectroscopy
  (Supplementary Note 5 and Supplementary Figs. 98–119). The permanent porosity of
  the PL-COFs was evaluated through nitrogen adsorption isotherms at 77 K. The derived
  Brunauer–Emmett–Teller surface areas ranged from 150 to 1,680 m2 g−1 (Supplementary
  Note 6 and Supplementary Figs. 120–140). Optical properties of these COFs were evaluated
  through ultraviolet–visible light absorption (Supplementary Note 7 and Supplementary
  Figs. 141–162) and fluorescence spectroscopy (Supplementary Figs. 163–182).


  Accurate structural determination of COFs is crucial for establishing reliable structure–property
  correlations and exploring the underlying mechanisms. Representative COFs in this
  series, PL-COF-3 and PL-COF-4 in Gen I and PL-COF-11 in Gen III, were analysed by
  electron diffraction (ED) and imaged using transmission electron microscopy (TEM).
  These COF crystals exhibited layered rhombus morphology with sizes up to 0.5 µm
  (Supplementary Figs. 27–29). ED patterns revealed a distinct mirror plane perpendicular
  to the COF layer, further confirmed by the corresponding TEM images. These observations
  were consistent with the structural models based on the bex topology. There were
  several possible structures under the same topology, in which the orientation of
  the building blocks and the conformation of the C=N linkage varied (Supplementary
  Figs. 25–26). Detailed analysis of the unit cell parameters difference enabled precise
  discrimination among these variants. For PL-COF-4, the a/b ratio derived from the
  ED pattern was 1.29, in good accordance with the modelled value of 1.26. In this
  configuration, the long axis of the pyrene unit in Ami-8 was parallel to that of
  the ald unit, Ald-13, and the C=N bonds adopted an orthogonal orientation. This
  was consistent with the conformation of pyrene and the C=N bond in Py-1P solved
  by single-crystal X-ray diffraction[29] but distinctly different from the model
  proposed in previous studies with an a/b ratio of 1.49[13]. Similarly, for PL-COF-11,
  the a/b ratio derived from the ED pattern was 1.48, in good accordance with the
  modelled value of 1.50, and both the C=C bond in Ami-11 and the C=N linkage were
  parallel to the long axis of the ald unit, Ald-13. This structure also diverged
  markedly from that reported in the literature with an a/b ratio of 1.83[14]. To
  further confirm the structure in real space, high-resolution TEM (HR-TEM) was performed.
  Although the electron beam sensitivity of COFs[33], two types of pores could be
  clearly observed, with resolutions of 4.4 Å, 4.1 Å and 5.1 Å for PL-COF-3, PL-COF-4
  and PL-COF-11, respectively, corresponding to diamond-shaped and hexagonal pores
  in these COFs. The distance between adjacent Ald-13 units was 2.1 nm, as measured
  from the HR-TEM images; this complied well with the corresponding structure refined
  by PXRD, further reinforcing the validity of the structure models.


  </block>

  ### Mechanism studies

  <block id="6">

  Recently, fluorescent COFs emerged as new frontiers in the exploration of the optical
  properties of COFs[34–39]. However, the underlying mechanism remained largely unknown.
  Insight into these mechanisms is highly valuable as guidance for the future design
  of fluorescent COFs.


  Here the AI model obtained after experiment–learning evolution of 22 PL-COFs was
  used to reveal the mechanism, correlating the electronic structure parameters of
  the building block with the fluorescence properties of the corresponding COFs. To
  elucidate the key contributing factors, 28 descriptors of the building blocks were
  ranked by the Shapley additive explanations model. Among the top six descriptors
  highlighting the relevance to the fluorescence properties of COFs, five originated
  from the ald unit (electrophilicity index, Mulliken electronegativity, electron
  delocalization index, hole delocalization index and h index) and one from the ami
  unit (Sr index). For ald units, a larger Mulliken electronegativity indicates a
  reduced propensity to accept electrons, enhancing COF fluorescence. Conversely,
  a higher electrophilicity index suggests an increased tendency to accept external
  electrons and undergo electrophilic reactions, showing an opposing trend. This demonstrates
  that ald units with greater electronegativity are more likely to favour the fluorescence
  of COFs. Among the hole–electron distribution descriptors, a higher electron delocalization
  index implies a smaller spatial distribution region of the unoccupied transition
  orbitals, whereas a smaller hole delocalization index and larger h index represent
  more diffuse occupied transition orbitals and hole–electron average distribution,
  all contributing to enhanced fluorescence. This suggests that ald units with concentrated
  unoccupied transition orbitals and spread-out occupied transition orbitals promote
  COF fluorescence. For ami units, a larger Sr index reflects greater spatial overlap
  between holes and electrons, indicating that stronger localized excitation characteristics
  lead to reduced fluorescence.


  Furthermore, systematic analysis of electron–hole distributions in the dimers of
  22 PL-COFs revealed distinctively different patterns between fluorescent and non-fluorescent
  COFs. In highly fluorescent COFs, including PL-COF-4, PL-COF-8, PL-COF-9, PL-COF-10,
  PL-COF-11, PL-COF-16, PL-COF-21 and PL-COF-22, the electron–hole pairs were predominantly
  localized near the ald units. By contrast, the electron–hole distribution was mainly
  found on ami units for dimers in most of the weak or non-fluorescent COFs (PL-COF-1
  to PL-COF-3, PL-COF-5 to PL-COF-7, PL-COF-12 to PL-COF-13, and PL-COF-15 to PL-COF-19).
  Quantitative assessment of electron–hole distributions of the dimers further supported
  this trend. A greater contribution of electron and hole density from the ald unit
  was correlated with an increased PLQY value, as reflected by the clustering of red
  points at the upper-right corner representing highly fluorescent COFs. On the contrary,
  a smaller contribution from the ami unit was correlated with greater fluorescence.
  Localized excitation within the ald unit was likely to be the fluorophore, whereas
  the ami unit might act as a quencher.


  Note that these quantitative contributions from electron–hole distributions of the
  dimers were also employed as output parameters in the pretraining model, further
  indicating their critical role in the explanation of the fluorescence properties
  of COFs. To verify the correlation between dimers and the COF, two dimers were synthesized:
  dimer-1, derived from weakly fluorescent PL-COF-3; and dimer-2, derived from strongly
  fluorescent PL-COF-11 (Supplementary Figs. 185–194). Their photophysical behaviours
  mirrored those of the corresponding COFs.


  Efficient local electron excitation on the ald unit is critical for the overall
  fluorescence of the COF. Strong donor–acceptor–donor motifs in ald, such as in Ald-13,
  which is quite stable even in the presence of influence from ami, are favourable
  to generation of strong fluorescence in COF. When combined with various ami units,
  the match between HOMO and LUMO of both ald and ami units was another requirement
  for the overall fluorescence of the COF. For example, amino units such as Ami-8,
  Ami-11 and Ami-17, with HOMO levels higher than that of Ald-25, promoted electron
  transfer from ami to ald units. By contrast, the HOMO alignment between Ami-10 and
  Ald-25 reduced electron transfer, leading to moderate fluorescence (5.7%). The HOMO
  of Ald-25 exceeded that of Ami-12 and its LUMO was lower, leading to maintenance
  of high fluorescence. This HOMO–LUMO alignment trend was consistently observed across
  all 22 experimentally obtained PL-COFs (Supplementary Fig. 24). In highly fluorescent
  PL-COF-4 and PL-COF-22, the ald units exhibited both higher HOMOs and lower LUMOs
  than the ami units, and the excited-state electron–hole distributions were localized
  on the ald fluorophores. Such a phenomenon can also be observed in molecules, where
  photo-induced electron transfer (PET) theory applies. Although PET theory has been
  previously proposed to explain the fluorescence properties of COFs[40], among many
  other possible mechanisms[41,42], this work establishes a robust and quantitative
  correlation based on a large variety of COF structures, rather than single cases.


  Systematic analysis of the HOMO–LUMO levels of 11 ald and 6 ami units using DFT
  calculations further confirmed that the enveloping of the HOMO and LUMO of the ald
  units within those of the ami units was a prerequisite for inhibition of PET, hence
  the strengthening of the fluorescence of the COF. This was consistent with the experimental
  observations. In addition, femtosecond pump-probe transient absorption measurements
  were conducted (Supplementary Note 8, Supplementary Figs. 183–184 and Supplementary
  Table 4). PL-COF-9 and PL-COF-11, with high PLQY values, exhibited time delays on
  the scale of 1 ns, indicating suppressed intramolecular electron transfer, in good
  accordance with the HOMO–LUMO analysis of their constituent building blocks. By
  contrast, PL-COF-1, PL-COF-2, PL-COF-12 and PL-COF-16, with weak or no fluorescence,
  showed fast transient absorption intensity delays within 100 ps, revealing fast
  electron transfer in these COFs upon light irradiation. Note that PL-COF-3, PL-COF-5,
  PL-COF-12, PL-COF-15, PL-COF-16 and PL-COF-19, which contained aggregation-induced
  emission motifs in building blocks (Supplementary Note 9 and Supplementary Figs.
  195–201), displayed negligible fluorescence in the experimental measurements, further
  implying that the governing mechanism here was different from the aggregation-induced
  emission effect.


  </block>

  ### Two-photon fluorescence bioimaging

  <block id="7">

  Fluorescent COFs hold great promise as probes for bioimaging[43,44], as the photo-bleaching
  effect from small molecules can be largely alleviated. To achieve deeper imaging
  depth and a higher signal-to-noise ratio, light absorption with a longer wavelength
  was highly desirable[45]; here two-photon fluorescence (2PF) is an effective solution[46–48].
  In previous studies, we showed that COFs with strong one-photon fluorescence often
  exhibited 2PF[49]. Here we also applied the above COFs in the 2PF performance test,
  using PL-COF-11 as an example. A power-dependent fluorescence slope of 1.9 was observed
  in the test of PL-COF-11 nanoparticles, with an average crystal size of 100 nm (Supplementary
  Note 10 and Supplementary Figs. 202–204), under an excitation wavelength of 1,200
  nm; this demonstrated a 2PF property in the near-infrared (NIR)-II region, which
  is ideally suited for bioimaging. In the test of mouse brain vasculature using a
  femtosecond laser with an excitation wavelength of 1,200 nm, nanosized PL-COF-11
  achieved an imaging depth of up to 924 µm in three-dimensional reconstructions.
  Capillaries as small as 1.9 µm were clearly resolved in deep tissue even at 800
  µm. By contrast, its molecular counterpart, the Ald-13 unit, yielded an imaging
  depth of only 520 µm, limited by its short absorption wavelength in light (810 nm,
  a typical NIR-I region). The enhanced 2PF performance of COFs was consistent with
  our previous observation[47], and here the 2PF absorption wavelength of COF was
  extended to the previously inaccessible NIR-II region, expanding its utility in
  bioimaging. Furthermore, photostability tests showed that the fluorescence of the
  Ald-13 unit diminished by 40% after 25 min of irradiation, whereas PL-COF-11 retained
  more than 90% of its initial fluorescence under the same conditions (Supplementary
  Fig. 207). Moreover, PL-COF-11 exhibited good biosafety, as evidenced by hematoxylin
  and eosin staining of major organs in mice and comprehensive routine blood and biochemical
  tests (Supplementary Figs. 208–210). This, combined with the superior photostability
  and deep-tissue imaging of PL-COF-11, means it is ideally suited as a probe for
  bioimaging.


  </block>

  ## Conclusion

  <block id="8">

  Despite advances in simulation techniques and the development of AI, the interplay
  between researchers and AI has yet to be fully established. In this study, an interactive
  experiment–learning method was used to integrate model prediction, experimental
  validation and active learning through progressive evolution cycles. This approach
  enabled us to identify highly fluorescent COFs through only a few iteration cycles
  and with a small number of experimental variety searches.


  The embedding of electronic structure in an AI model transcended the classic intuition
  gained from a chemical formula, enabling us to gain chemical insight concerning
  the frontier orbitals and excited state. This resulted in much better correlations
  with the chemical and physical properties associated with electronic structures,
  as exemplified by the fluorescence here. A Siamese neural network, previously used
  in image recognition[50,51] and spectral analysis[52], was used here as an efficient
  model to recommend COF structures based on limited experimental results, demonstrating
  its power for discovery of materials.


  This approach, incorporating AI and efforts from researchers, was also shown to
  be efficient in mechanism studies. The knowledge accumulated from the interactive
  experiment–learning evolution here allowed extraction of chemical insights from
  the fact-supported AI model and thus offered accuracy and reliability beyond random
  guesses. The conventional view that imine linkages are formidably disfavoured was
  overturned in the fluorescent COFs studied here, whereas matching of HOMO–LUMO between
  building units was found to be critical to achieving high fluorescence. Such knowledge
  will be valuable for the future design of COFs but could not be extracted and verified
  without the assistance of AI.


  </block>

  ## Online content

  <block id="9">

  Any methods, additional references, Nature Portfolio reporting summaries, source
  data, extended data, supplementary information, acknowledgements, peer review information;
  details of author contributions and competing interests; and statements of data
  and code availability are available at https://doi.org/10.1038/s41557-025-01974-x.


  </block>

  ## Methods

  <block id="10">


  </block>

  ### Chemicals

  <block id="11">

  The ami and ald building blocks were bought from Shanghai Kyl-pharm. Co., Ltd. Puromycin,
  and organic solvents, including o-dichlorobenzene, n-butanol, dioxane, acetic acid
  and acetone, were procured from Adamas-beta. All chemicals were of analytical grade
  and were utilized without further purification.


  </block>

  ### Animals

  <block id="12">

  The C57BL/6 mice (6–8 weeks old, approximately 20 g) utilized in this study were
  obtained from SLAC Laboratory Animal (Shanghai, China). All experimental animals
  were housed under standardized conditions at the Laboratory Animal Center of Zhejiang
  University and maintained in specific-pathogen-free environments with a 12-h light/dark
  cycle, room temperature of 25 °C and humidity levels of 50.0 ± 5.0%. The animals
  had ad libitum access to food and water, and there was no sex bias in the selection
  of subjects. All experimental procedures received approval from the Animal Use and
  Care Committee at Zhejiang University (ZJU20240156).


  </block>

  ### Construction and activation of PL-COFs

  <block id="13">

  A Pyrex tube was charged with 0.1 mmol tetratopic ami building blocks and 0.1 mmol
  tetratopic ald; to this mixture, o-dichlorobenzene (1.5 ml) and n-butanol (1.5 ml)
  were added, followed by addition of 300 µl of acetic acid (6 M). The resulting mixture
  was rapidly frozen at 77 K (liquid N2 bath), evacuated to an internal pressure of
  30 mTorr and sealed by flame to maintain a length of 20 cm. After a natural warm-up
  to room temperature, the tube was transferred to an oven and heated at 120 °C for
  7 days. The PL-COF samples were obtained by filtration, subsequently washed with
  acetone, and sequentially fluxed with dioxane and acetone in a Soxhlet extractor
  for 24 h for each solvent. Then, the PL-COF samples were heated to 120 °C and kept
  at the same temperature for 12 h to achieve complete activation.


  </block>

  ### Automated pipeline for extracting ald and ami precursors from relevant COF literature

  <block id="14">

  To automate the extraction of ald and ami precursors used in the synthesis of COFs,
  we developed a data extraction pipeline that leveraged the OpenAI GPT-4o API. This
  pipeline was applied to a dataset of 132 imine COF-related papers, including 6 review
  articles and 126 original research papers. Each paper was processed to identify
  and record relevant ald and ami precursors, along with their specific roles in COF
  synthesis.


  The pipeline began with loading of full-text PDFs using the PyPDFLoader from LangChain,
  which extracts content on a per-page basis. This extracted text was then fed into
  the GPT-4o model, guided by a custom system prompt designed to focus on identification
  of precursor compounds and their involvement in COF formation. The model output
  structured data in compliance with OpenAI’s structured output format, ensuring consistency
  and precision. To validate the structured data, we employed Pydantic models, which
  ensured correct extraction of precursor names, their roles and the corresponding
  paper titles, thereby ensuring accuracy in extracting the information. This process
  resulted in a reliable, reproducible pipeline for extraction and categorization
  of chemical precursors essential to COF research.


  </block>

  ### Calculation of optoelectronic properties for the building units of PL-COF

  <block id="15">

  DFT was utilized to elucidate the optoelectronic characteristics of ald and ami
  functional groups forming COFs. These characteristics, reflecting both excited-state
  behaviour and molecular reactivity, were integrated as predictive variables in machine
  learning algorithms. Detailed process and calculation levels can be found in Supplementary
  Note 7.


  The derived optoelectronic properties were bifurcated into two main groups. The
  first encompassed descriptors of the initial singlet excited state (S1). This included
  the excitation energy, oscillator strength for absorption, and three metrics indicating
  the electron–hole spatial interaction: overlap index (Sr index), centroid distance
  and separation index. In addition, four parameters described the spatial extent
  of the electron–hole distribution: hole and electron delocalization indices, their
  dispersion difference and their average dispersion (h index). The second group contained
  descriptors indicating the electrochemical reactivity of the building blocks, including
  the vertical ionization potential, electron affinity, Mulliken electronegativity,
  electrophilicity and hardness.


  For dimer analyses, we explored the spatial distribution changes in electron–hole
  pairs postlinkage. Mulliken population analysis quantified the relative contributions
  of ami and ald units to the electron–hole distribution in the S1 state. These dimer
  properties formed the basis for training an MLP model, leveraging characteristics
  of the building blocks to predict excited-state behaviours.


  </block>

  ### Pretraining AI models and using them to inform interactive experiment–learning
  cycles

  <block id="16">

  The experimental objective of this study was to search for potential ald–ami pairings
  within a discrete sample matrix, organized as a 26 × 20 matrix of ami and ald building
  blocks, incorporating classic motifs used in the design of fluorescent molecules.
  Given this setup, Bayesian optimization, which is typically suited for continuous
  spaces, was not appropriate for this experimental context. Instead, as precalculated
  optoelectronic features were available for each ald and ami building block, as well
  as their dimers, leveraging these feature vectors through a deep-learning model
  was more effective. This led us to opt for the Siamese network, which is specially
  designed for similarity measurement tasks. In addition, the Siamese neural network
  offers an advantage in small datasets, as it learns similarities between input pairs
  (in this case, two ald–ami dimers). By comparing pairs, the model can combine any
  ald–ami dimer with others to form new input pairs, increasing the amount of data
  available for training. This approach enhances the model’s ability to learn, despite
  the limitations imposed by the small dataset.


  For each ald–ami dimer, the input was constructed as a concatenated vector pair
  comprising a 14-dimensional feature vector for the ald and a 14-dimensional feature
  vector for the ami. Before model training, all features were scaled using min–max
  normalization to ensure proportional contributions from each feature during training.
  We employed a Siamese neural network to measure the performance differences of each
  ald–ami dimer. The Siamese network was implemented using a shared MLP encoder and
  trained to minimize both contrastive loss and mean squared error. Detailed architecture,
  optimization parameters and training procedures are described in Supplementary Note
  1. To develop a robust feature extractor, we pre-trained a model before making recommendations.
  The input was a 28-dimensional ald–ami dimer vector, and the prediction target was
  to estimate the electron–hole distribution of the dimer formed by this ald–ami pair
  (as described in Supplementary Information: Supplementary Note 1). Initially, five
  random ald–ami dimers were recommended. In each recommendation cycle, we paired
  previously tested dimers, refined the Siamese network with a pretrained extractor
  and evaluated untested dimers on the basis of their similarity to tested pairs.
  The top-performing dimers were then selected for further experimentation based on
  these evaluations.

  </block>'
